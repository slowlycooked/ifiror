<% content_for :title, '费项明细' %>
<p>
  <strong>账本名称:</strong>
  <%= @book.book_name %>
</p>


<div class="row">
  <div class="col-xs-6">
    <%= link_to '返回费项列表', book_path(@book), class: 'btn btn-primary' %>
  </div>
  <div class="col-xs-6">
    <%= link_to '编辑费项名称', edit_book_fee_path(@book, @fee) %>
  </div>

</div>


<br>

<div id="no-more-tables">
  <table class="table table-responsive table-striped table-hover table-condensed table-bordered " style="border: 2px solid orange">
    <thead>
    <tr>
      <th>费项</th>
      <th>收入</th>
      <th>支出</th>
      <th>余额</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td class="head_sum" data-title="费项"><%= @fee.fee_name %></td>
      <td class="head_sum" data-title="收入"><%= @credit_sum %></td>
      <td class="head_sum" data-title="支出"><%= @debit_sum %></td>
      <td class="head_sum" data-title="余额"><%= @credit_sum-@debit_sum %></td>
    </tr>

    </tbody>
  </table>

  <table class="table table-responsive table-striped table-hover table-condensed table-bordered ">
    <thead>
    <tr>
      <th>日期</th>
      <th>收入</th>
      <th>支出</th>
      <th colspan="2"></th>
    </tr>
    </thead>

    <tbody>
    <% @records.each do |record| %>
        <tr>
          <td class="numeric" data-title="日期">
            <%= record.updated_at.strftime('%Y/%m/%d') %>
          </td>
          <td class="numeric" data-title="收入"><%= record.credit %></td>
          <td class="numeric" data-title="支出"><%= record.debit %></td>
          <td><%= link_to '编辑', edit_book_fee_fee_record_path(@book.id, record.fee_id, record) %></td>
          <td><%= link_to '删除', book_fee_fee_record_path(@book.id, record.fee_id, record), method: :delete, data: {confirm: '确定删除吗？'} %></td>
        </tr>
    <% end %>
    <tr>
      <%= form_for([@book, @fee, @fee.fee_records.build]) do |f| %>

          <td class="numeric" data-title="日期">

            <!--%= Time.now.strftime('%Y/%m/%d') %-->
            <div id="sandbox-container" style="font-size: 12px;">
              <%= f.text_field :updated_at, 'data-provide' => 'datepicker', value:Time.now.strftime('%Y/%m/%d') %>
            </div>
            <script>
                $(document).ready(function () {
                    $('#sandbox-container input').datepicker({
                        format: "yyyy/mm/dd",
                        language: "zh-CN",
                        orientation: "top",
                        todayHighlight: true
                    });
                });
            </script>
          </td>
          <td class="numeric" data-title="收入">
            <%= f.text_field :credit, size: '6', value: 0, onfocus: "if(this.value == '0') { this.value = ''; }" %>
          </td>
          <td class="numeric" data-title="支出">
            <%= f.text_field :debit, size: '6', value: 0, onfocus: "if(this.value == '0') { this.value = ''; }" %>
          </td>
          <td></td>
          <td colspan="2"> <%= f.submit '保存新记录', class: 'btn btn-primary btn-sm' %></td>
      <% end %>
    </tr>

    </tbody>
  </table>
</div>

<div class="col-xs-4">
  <%= link_to '删除费项', book_fee_path, method: :delete, data: {confirm: '确定删除费项吗？将清除该费项所有信息！！'} %>
</div>


